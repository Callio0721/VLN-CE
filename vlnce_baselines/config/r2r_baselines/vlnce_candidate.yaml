# ğŸ”¥ ä¿®æ”¹è¿™é‡Œï¼ŒæŒ‡å‘æ–°çš„åŸºç¡€é…ç½®
BASE_TASK_CONFIG_PATH: habitat_extensions/config/vlnce_task_candidate.yaml

# -----------------------------------------------------------------------------
# ç¡¬ä»¶ä¸ç³»ç»Ÿè®¾ç½®
# -----------------------------------------------------------------------------
SIMULATOR_GPU_IDS: [2,3,4,5,6] # [0,1,2,3,4,5,6] 
TORCH_GPU_ID: 2
NUM_ENVIRONMENTS: 8

TENSORBOARD_DIR: data/tensorboard_dirs/candidate_cma_clip_bert
CHECKPOINT_FOLDER: data/checkpoints/candidate_cma_clip_bert
EVAL_CKPT_PATH_DIR: data/checkpoints/candidate_cma_clip_bert
RESULTS_DIR: data/checkpoints/candidate_cma_clip_bert/evals

# ... (ä¸­é—´çš„ EVAL, IL ç­‰è®¾ç½®ä¿æŒä¸å˜) ...
EVAL:
  USE_CKPT_CONFIG: False
  SPLIT: val_unseen
  EPISODE_COUNT: -1

# -----------------------------------------------------------------------------
# æ¨¡ä»¿å­¦ä¹  (Imitation Learning) è®¾ç½®
# -----------------------------------------------------------------------------
IL:
  # å®˜æ–¹é»˜è®¤ 45ï¼ŒBERT+CLIP æ”¶æ•›å¿«ï¼Œä½†ä¿æŒ 45 å¯ä»¥è·‘å‡ºæ›´é«˜åˆ†
  epochs: 45
  batch_size: 3

  DAGGER:
    iterations: 1 # Stage 1: çº¯ Teacher Forcing
    lmdb_fp16: True
    # R2R (10k) + Aug (147k) â‰ˆ 15.7ä¸‡æ¡æ•°æ®
    # è¿™æ˜¯æœ€è€—æ—¶çš„æ­¥éª¤ï¼Œè¿›åº¦æ¡ä¼šèµ°å¾ˆä¹…ï¼Œè€å¿ƒç­‰å¾…
    update_size: 80000
    
    p: 1.0

    # ç¬¬ä¸€æ¬¡è·‘è®¾ä¸º False (ç”Ÿæˆæ•°æ®)
    # å¦‚æœä¸­é€”æ–­äº†æƒ³ç»­ä¼ ï¼Œä»£ç ä¼šè‡ªåŠ¨æ£€æµ‹ç›®å½•éç©ºï¼Œä¸ç”¨æ‰‹åŠ¨æ”¹ True
    preload_lmdb_features: False
    lmdb_features_dir: data/trajectories_dirs/vlnce_candidate/trajectories.lmdb
    lmdb_map_size: 2e12
# -----------------------------------------------------------------------------
# ä»»åŠ¡ä¸ä¼ æ„Ÿå™¨é…ç½®
# -----------------------------------------------------------------------------
TASK_CONFIG:
  TASK:
    # åªéœ€è¦è¦†ç›– Sensor åˆ—è¡¨å³å¯ï¼ŒACTIONS å·²ç»ç”± BASE_TASK_CONFIG_PATH å®šä¹‰å¥½äº†
    # SENSORS: ['RGB_SENSOR', 'DEPTH_SENSOR', 'INSTRUCTION_SENSOR']
    # SENSORS: ['INSTRUCTION_SENSOR', 'SHORTEST_PATH_SENSOR', 'VLN_ORACLE_PROGRESS_SENSOR', 'WAYPOINT_SENSOR']
    # SENSORS: ['BERT_INSTRUCTION_SENSOR', 'SHORTEST_PATH_SENSOR', 'VLN_ORACLE_PROGRESS_SENSOR'] 
    SENSORS: ['BERT_INSTRUCTION_SENSOR', 'SHORTEST_PATH_SENSOR', 'VLN_ORACLE_PROGRESS_SENSOR', 'WAYPOINT_SENSOR']


# æ¨¡å‹ç»“æ„é…ç½®
# -----------------------------------------------------------------------------
MODEL:
  policy_name: CandidateCMAPolicy
  CANDIDATE:
    num_candidates: 12

  # --- 1. è¯­è¨€ç¼–ç å™¨ (BERT) ---
  INSTRUCTION_ENCODER:
    rnn_type: "BERT"
    vocab_size: 30522
    embedding_size: 768
    hidden_size: 256
    fine_tune_bert: False
    final_state_only: False
  # INSTRUCTION_ENCODER:
  #   rnn_type: "LSTM"
  #   bidirectional: True

  # --- 2. è§†è§‰ç¼–ç å™¨ (CLIP) ---
  RGB_ENCODER:
    cnn_type: "ClipVisualEncoder"
    output_size: 256
    trainable: True

  # --- 3. æ·±åº¦ç¼–ç å™¨ (ResNet) ---
  DEPTH_ENCODER:
    cnn_type: "VlnResnetDepthEncoder"
    output_size: 128
    backbone: "resnet50"
    ddppo_checkpoint: "data/ddppo-models/gibson-2plus-resnet50.pth" # ç¡®ä¿å­˜æ”¾äº†DDPPOæƒé‡
    trainable: False

  # --- 4. çŠ¶æ€ç¼–ç å™¨ (RNN) ---
  STATE_ENCODER:
    hidden_size: 512
    rnn_type: "GRU"

  # --- 5. è¿›åº¦ç›‘æ§ ---
  PROGRESS_MONITOR:
    use: True
    alpha: 1.0